# AppraisalParticipant (Участник анкетирования)
## Создание

`POST /api/appraisals/{appraisalId}/participants`

где ```appraisalId``` - идентиифкатор анкетирования

Пример сообщения в Body запроса:

```json
{
    "externalId": "externalID1104",
    "participantUserExternalId": "SU44617",
    "dateCompleted": "2018-07-01T00:00:00+03:00",
    "isMain": false,
    "textFeedback": "0KLRg9GCINGA0LDQt9C90YvQtSDQv9C+0LvQtdC30L3Ri9C1INGA0LXQutC+0LzQtdC90LTQsNGG0LjQuCA=",
    "textHint": "0KLRg9GCINGA0LDQt9C90YvQtSDQv9C+0LvQtdC30L3Ri9C1INGA0LXQutC+0LzQtdC90LTQsNGG0LjQuCA=",
    "status": 3,
    "participationReason": "0KLRg9GCINGA0LDQt9C90YvQtSDQv9C+0LvQtdC30L3Ri9C1INGA0LXQutC+0LzQtdC90LTQsNGG0LjQuCA=",
    "requestDate": "2019-01-15T00:00:00+03:00",
    "responseDate": "2018-12-25T00:00:00+03:00"
}
```

### Описание полей

|Поле|Тип|Ограничения|Описание|
|----|--------|------------|------------|
|externalId|string| Unique |Внешний идентификатор (опциональный)|
|participantUserExternalId|string|Not Null |Идентификатор пользователя из внешней системы, участника-оценивающего|
|dateCompleted| datetime (подробнее о формате [здесь](general.md))| Not Null |Дата выполнения|
|isMain| boolean  |Not Null | Является ли участник основным оценивающим|
|textFeedback| string | - | Текстовый отзыв. Строка, закодированная в Base64|
|textHint| string | - | Тестовая подсказка от основного оценивающего. Строка, закодированная в Base64|
|status| Значения из [перечисления](#appraisalParticipant_status)| Not Null | Статус участника анкетирования|
|participationReason| string | - | Основание участия. Строка, закодированная в Base64|
|requestDate| datetime (подробнее о формате [здесь](general.md))|-| Дата отправки |
|requestLastDate| datetime (подробнее о формате [здесь](general.md))|-| Дата получения ответа |

<a name="appraisalParticipant_status"></a>
#### Статус участника анкетирования
|Значение|Описание|
|----|--------|
| 1 | Запрошен | 
| 2 | Предоставлен |
| 3 | Не запрошен |
| 4 | Нет возможности оценить|
| 5 | Удален|

### Логика работы

Если не были переданы обязательные пераметры, то будет возвращен код ```400 BadRequest ```.
В случае создания записи будет возвращен статус ```201 Created```, в теле ответа будет содержаться идентификатор созданной сущности, в заголовке URL.</br>

## Обновление

`PUT /api/appraisals/{appraisalId}/participants/{participantId}`

где ```appraisalId``` - идентиифкатор анкетирования, ```participantId``` - идентификатор участника этого анкетирования

### Логика работы

Сообщение в тело запроса соответствует сообщению для создания сущности. Сущность обновляется целиком (полная замена ресурса), поэтому должным быть заполнены все параметры. Если какой-то из параметров будет отсутствовать в теле запроса, то это будет воспринято как заполнение пустым значением.
</br>

Если не были переданы обязательные пераметры, то будет возвращен код ```400 BadRequest ```. Если анкетирование с переданным идентификатором не будет найдено, то будет передан код ```404 NotFound```.
В случае успешного обновления записи будет возвращен статус ```200 OK```.


## Частичное обновление

`PATCH /api/appraisals/{appraisalId}/participants/{participantId}`

где ```appraisalId``` - идентиифкатор анкетирования, ```participantId``` - идентификатор участника этого анкетирования

Для частичного обновления ресурса используется формат [JSON Patch](http://jsonpatch.com/). Пример Body запроса:

```json
[
    {
        "op": "replace",
        "path": "/dateCompleted",
        "value": "2020-07-10T00:00:00+03:00"
    }
]
```

### Логика работы

Формата JSON Patch позволяет манипулировать отдельными полями сущности (замена, копирование, удаление).
</br>

Если не были переданы обязательные пераметры, то будет возвращен код ```400 BadRequest ```. Если анкетирование с переданным идентификатором не будет найдено, то будет передан код ```404 NotFound```.
В случае успешного обновления записи будет возвращен статус ```200 OK```.


## Удаление


`DELETE /api/appraisals/{appraisalId}/participants/{participantId}`

где ```appraisalId``` - идентиифкатор анкетирования, ```participantId``` - идентификатор участника этого анкетирования


### Логика работы

Если не были переданы обязательные пераметры, то будет возвращен код ```400 BadRequest ```. Если анкетирование с переданным идентификатором не будет найдено, то будет передан код ```404 NotFound```.
В случае успешного обновления записи будет возвращен статус ```200 OK```.
